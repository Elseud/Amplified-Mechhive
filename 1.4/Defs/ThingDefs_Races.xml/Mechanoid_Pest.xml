<?xml version="1.0" encoding="utf-8"?>
<Defs>
    <ThingDef ParentName="BaseMechanoid">
        <defName>VM_Pest</defName>
		<label>pest</label>
		<description>A medium-sized mechanoid with a tank full of toxins attached to it's back. They can inject their victims with deadly toxins using their pincers while their spits and an inbuilt toxthrower allow them to safely attack from the distance.</description>

		<statBases>
			<MoveSpeed>4.0</MoveSpeed>
			<ArmorRating_Blunt>0.25</ArmorRating_Blunt>
			<ArmorRating_Sharp>0.25</ArmorRating_Sharp>
		</statBases>

        <tools>
			<li>
				<label>right pincer</label>
				<capacities>
					<li>VM_CutToxic</li>
				</capacities>
				<power>4</power>
				<cooldownTime>2</cooldownTime>
				<linkedBodyPartsGroup>VM_RightPincer</linkedBodyPartsGroup>
				<alwaysTreatAsWeapon>true</alwaysTreatAsWeapon>
			</li>

			<li>
				<label>left pincer</label>
				<capacities>
					<li>VM_CutToxic</li>
				</capacities>
				<power>4</power>
				<cooldownTime>2</cooldownTime>
				<linkedBodyPartsGroup>VM_LeftPincer</linkedBodyPartsGroup>
				<alwaysTreatAsWeapon>true</alwaysTreatAsWeapon>
			</li>
		</tools>

        <race>
			<intelligence>ToolUser</intelligence>
			<thinkTreeMain>Mechanoid</thinkTreeMain>
			<body>VM_MechanicalPest</body>
			<baseBodySize>0.6</baseBodySize>
			<baseHealthScale>0.75</baseHealthScale>
            <deathActionWorkerClass>VanMechanoids.DeathActionWorker_PestToxCloud</deathActionWorkerClass>

			<lifeStageAges Inherit="False">
				<li>
					<def>MechanoidFullyFormed</def>
					<minAge>0</minAge>
					<soundWounded>Pawn_Mech_Scyther_Wounded</soundWounded>
					<soundDeath>Pawn_Mech_Scyther_Death</soundDeath>
					<soundCall>Pawn_Mech_Scyther_Call</soundCall>
				</li>
				<li>
					<def>MechanoidFullyFormed</def>
					<minAge>100</minAge>
					<soundWounded>Pawn_Mech_Scyther_Wounded</soundWounded>
					<soundDeath>Pawn_Mech_Scyther_Death</soundDeath>
					<soundCall>Pawn_Mech_Scyther_Call</soundCall>
				</li>
			</lifeStageAges>

			<soundCallIntervalRange>1000~2000</soundCallIntervalRange>
			<soundMeleeHitPawn>Pawn_Melee_MechanoidSlash_HitPawn</soundMeleeHitPawn>
			<soundMeleeHitBuilding>Pawn_Melee_MechanoidSlash_HitBuilding</soundMeleeHitBuilding>
			<soundMeleeMiss>Pawn_Melee_MechanoidSlash_Miss</soundMeleeMiss>
			<mechWeightClass>Light</mechWeightClass>
		</race>

		<butcherProducts>
			<Steel>10</Steel>
		</butcherProducts>

		<comps>
			<li Class="VanMechanoids.CompProperties_BodypartHediff">
				<bodyPartDef>VM_ToxinContainer</bodyPartDef>
				<hediffDef>VM_ToxBomb</hediffDef>
			</li>
		</comps>

    </ThingDef>

	<PawnKindDef parentName="BaseMechanoidKind" Class="PawnKindDef">
		<defName>VM_Pest</defName>
		<label>pest</label>
		<race>VM_Pest</race>
		<combatPower>200</combatPower>
		<defaultFactionType>Mechanoid</defaultFactionType>

		<!-- <aiAvoidCover>true</aiAvoidCover> --> <!-- Van wanted them to be annoying. If seeking cover is too much just disable the line -->

		<lifeStages Inherit="False">
			<li>
				<bodyGraphicData>
					<texPath>Things/Pawn/Mechanoid/Mech_Pest/PestClean</texPath>
					<maskPath>Things/Pawn/Mechanoid/AllegianceOverlays/Pest</maskPath>
					<shaderType>CutoutWithOverlay</shaderType>
					<graphicClass>Graphic_Multi</graphicClass>
					<drawSize>1.5</drawSize>
					<shadowData>
						<volume>(0.3, 0.3, 0.3)</volume>
					</shadowData>
				</bodyGraphicData>
			</li>

			<li>
				<bodyGraphicData>
					<texPath>Things/Pawn/Mechanoid/Mech_Pest/Pest</texPath>
					<maskPath>Things/Pawn/Mechanoid/AllegianceOverlays/Pest</maskPath>
					<shaderType>CutoutWithOverlay</shaderType>
					<graphicClass>Graphic_Multi</graphicClass>
					<drawSize>1.5</drawSize>
					<shadowData>
						<volume>(0.3, 0.3, 0.3)</volume>
					</shadowData>
				</bodyGraphicData>
			</li>
		</lifeStages>

        <weaponMoney>9999~9999</weaponMoney>

        <weaponTags>
            <li>VM_PestSpitter</li>
        </weaponTags>

        <techHediffsChance>1</techHediffsChance>
        <techHediffsMoney>9999~9999</techHediffsMoney>
	</PawnKindDef>

    <ThingDef ParentName="BaseGun">
        <defName>VM_PestSpitter</defName>
        <label>toxin spitter</label>
        <description>An inbuilt pressurized liquid launcher capable of shooting globs composed of a highly poisonous toxin diluted with oil.</description>
        <techLevel>Spacer</techLevel>
        <tradeability>None</tradeability>
        <destroyOnDrop>true</destroyOnDrop>
        <relicChance>0</relicChance>
        <graphicData>
          <texPath>UI/Abilities/VM_AcidSpit</texPath>
          <graphicClass>Graphic_Single</graphicClass>
          <color>(1, 1, 1, 0)</color>
        </graphicData>

        <statBases>
          <MarketValue>1200</MarketValue>
          <Mass>4.6</Mass>
          <AccuracyTouch>1.0</AccuracyTouch>
          <AccuracyShort>0.90</AccuracyShort>
          <AccuracyMedium>0.80</AccuracyMedium>
          <AccuracyLong>0.60</AccuracyLong>
          <RangedWeapon_Cooldown>1</RangedWeapon_Cooldown>
        </statBases>

        <weaponTags>
          <li>VM_PestSpitter</li>
        </weaponTags>

        <weaponClasses>
          <li>RangedLight</li>
        </weaponClasses>

        <verbs>
          <li>
            <verbClass>Verb_Shoot</verbClass>
            <hasStandardCommand>true</hasStandardCommand>
            <defaultProjectile>VM_PestSpit</defaultProjectile>
            <warmupTime>1.5</warmupTime>
            <range>25.9</range>
            <burstShotCount>1</burstShotCount>
            <soundCast>AcidSpray_Resolve</soundCast>
            <soundCastTail>GunTail_Light</soundCastTail>
            <muzzleFlashScale>9</muzzleFlashScale>
          </li>
        </verbs>
      </ThingDef>

    <ThingDef>
        <defName>VM_PestSpit</defName>
        <label>acid</label>
        <thingClass>VanMechanoids.Projectile_PestSpit</thingClass>
        <category>Projectile</category>
        <tickerType>Normal</tickerType>
        <altitudeLayer>Projectile</altitudeLayer>
        <useHitPoints>False</useHitPoints>
        <neverMultiSelect>True</neverMultiSelect>

        <graphicData>
            <texPath>Things/Projectile/VM_AcidSpit</texPath> <!-- Temporary, swap when Van gets the icon done -->
            <graphicClass>Graphic_Single</graphicClass>
            <shaderType>MoteGlow</shaderType>
            <drawSize>1.2</drawSize>
        </graphicData>

        <projectile>
            <damageDef>AcidBurn</damageDef>
            <speed>45</speed>
            <damageAmountBase>7.5</damageAmountBase>
            <armorPenetrationBase>0.15</armorPenetrationBase>
            <stoppingPower>1</stoppingPower>
            <filth>Filth_SpentAcid</filth>
            <filthCount>1</filthCount>
        </projectile>
    </ThingDef>

    <DamageDef ParentName="CutBase">
        <defName>VM_CutToxic</defName>
        <label>toxic cut</label>
        <additionalHediffs>
            <li>
				<hediff>ToxicBuildup</hediff>
				<severityPerDamageDealt>0.0075</severityPerDamageDealt>
				<victimSeverityScaling>ToxicResistance</victimSeverityScaling>
				<inverseStatScaling>true</inverseStatScaling>
				<victimSeverityScalingByInvBodySize>true</victimSeverityScalingByInvBodySize>
            </li>
        </additionalHediffs>
		<damageEffecter>Impact_Toxic</damageEffecter>
    </DamageDef>

    <ToolCapacityDef>
        <defName>VM_CutToxic</defName>
        <label>toxic cut</label>
    </ToolCapacityDef>

    <ManeuverDef>
        <defName>VM_CutToxic</defName>
        <requiredCapacity>VM_CutToxic</requiredCapacity>
        <verb>
            <verbClass>Verb_MeleeAttackDamage</verbClass>
            <meleeDamageDef>VM_CutToxic</meleeDamageDef>
        </verb>
        <logEntryDef>MeleeAttack</logEntryDef>
        <combatLogRulesHit>Maneuver_Slash_MeleeHit</combatLogRulesHit>
        <combatLogRulesDeflect>Maneuver_Slash_MeleeDeflect</combatLogRulesDeflect>
        <combatLogRulesMiss>Maneuver_Slash_MeleeMiss</combatLogRulesMiss>
        <combatLogRulesDodge>Maneuver_Slash_MeleeDodge</combatLogRulesDodge>
    </ManeuverDef>

	<HediffDef>
		<defName>VM_ToxBomb</defName>
		<label>toxic bomb</label>
		<description>This part will explode upon destruction. You weren't supposed to see this.</description>
		<hediffClass>HediffWithComps</hediffClass>
		<comps>
			<li Class="VanMechanoids.HediffCompProperties_ToxBomb" />
		</comps>
		<stages>
			<li>
			  <becomeVisible>false</becomeVisible>
			</li>
		</stages>
	</HediffDef>

</Defs>